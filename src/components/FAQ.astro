---
export interface Props {
  class?: string;
}

const { class: className } = Astro.props;

const faqs = [
  {
    question: "What certifications do your manufacturing partners hold?",
    answer: "Our vetted manufacturing partners maintain various certifications including GMP (Good Manufacturing Practices), FDA facility registration, Health Canada site licenses, and third-party certifications like NSF, ISO, and organic certifications. We verify all certifications during our vendor onboarding process and can provide documentation under NDA for serious inquiries."
  },
  {
    question: "What are the minimum order quantities through your partners?",
    answer: "Minimum order quantities vary by manufacturer and product type. Generally, our partners offer MOQs starting from 500-1,000 units for bottled supplements and 2,500-5,000 units for specialized formats. We'll match you with partners that align with your volume requirements, whether you're launching a pilot run or scaling up production."
  },
  {
    question: "How long does the manufacturing process typically take?",
    answer: "Standard production timelines through our partner network range from 6-10 weeks for stock formulas and 8-12 weeks for custom formulations. This includes raw material procurement, manufacturing, quality testing, and packaging. We work with multiple partners to find the best timeline for your needs, and rush options may be available."
  },
  {
    question: "Can you help with custom formulation development?",
    answer: "Yes! We connect you with experienced formulators and R&D teams within our partner network who specialize in developing custom supplements. They'll work with you to create unique formulations that meet your specifications while ensuring regulatory compliance, stability, and market viability."
  },
  {
    question: "Do you handle packaging and labeling?",
    answer: "We coordinate comprehensive packaging solutions through our partners, including bottle selection, label design, and bilingual compliance labeling for the Canadian market. Our team ensures all packaging meets regulatory requirements for both US and Canadian markets, including proper nutrition facts panels and required disclaimers."
  },
  {
    question: "What quality control measures are in place?",
    answer: "Quality assurance is managed through our partner laboratories and manufacturing facilities. This includes raw material testing, in-process quality checks, and finished product testing for potency, microbiology, and heavy metals. We coordinate all testing requirements and ensure you receive complete Certificates of Analysis (COAs) for every batch."
  },
  {
    question: "Can you help with NPN applications for Canada?",
    answer: "We assist in preparing and submitting Natural Product Number (NPN) applications for the Canadian market. Our team helps compile the necessary documentation, ensures compliance with Health Canada requirements, and manages the submission process. While we cannot guarantee approval, we work to maximize your chances of success."
  },
  {
    question: "Do you offer international shipping?",
    answer: "Yes, through our logistics partners we can arrange shipping worldwide. We have experience with international documentation, customs requirements, and ensuring products meet destination country regulations. Our team coordinates with freight forwarders to ensure smooth delivery to your target markets."
  }
];
---

<div class={`faq-container ${className || ''}`}>
  <div class="max-w-4xl mx-auto">
    <div class="space-y-4">
      {faqs.map((faq, index) => (
        <div class="faq-item border border-mint-200 rounded-lg overflow-hidden">
          <button
            class="faq-trigger w-full px-6 py-4 text-left flex items-center justify-between hover:bg-mint-50 transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-mint-500 focus:ring-inset"
            aria-expanded="false"
            aria-controls={`faq-answer-${index}`}
            data-faq-index={index}
          >
            <span class="text-lg font-medium text-gray-900 pr-8">{faq.question}</span>
            <span class="faq-icon flex-shrink-0 ml-2" aria-hidden="true">
              <svg class="chevron-down w-5 h-5 text-mint-600 transition-transform duration-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
              </svg>
              <svg class="chevron-up w-5 h-5 text-mint-600 transition-transform duration-300 hidden" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 15l7-7 7 7" />
              </svg>
            </span>
          </button>
          <div
            id={`faq-answer-${index}`}
            class="faq-answer"
            aria-hidden="true"
          >
            <div class="px-6 py-4 text-gray-600 leading-relaxed">
              {faq.answer}
            </div>
          </div>
        </div>
      ))}
    </div>
  </div>
</div>

<style>
  .faq-answer {
    max-height: 0;
    overflow: hidden;
    transition: max-height 0.3s ease-out;
  }

  .faq-answer[aria-hidden="false"] {
    max-height: 500px;
    transition: max-height 0.3s ease-in;
  }

  .faq-trigger[aria-expanded="true"] .chevron-down {
    transform: rotate(180deg);
  }

  .faq-trigger:hover {
    background-color: rgba(167, 243, 208, 0.1);
  }

  @media (prefers-reduced-motion: reduce) {
    .faq-answer {
      transition: none;
    }
    
    .chevron-down,
    .chevron-up {
      transition: none;
    }
  }
</style>

<script>
  document.addEventListener('DOMContentLoaded', () => {
    const faqTriggers = document.querySelectorAll('.faq-trigger');
    
    faqTriggers.forEach(trigger => {
      trigger.addEventListener('click', () => {
        const index = trigger.dataset.faqIndex;
        const answer = document.getElementById(`faq-answer-${index}`);
        const isExpanded = trigger.getAttribute('aria-expanded') === 'true';
        
        // Close all other FAQs
        faqTriggers.forEach(otherTrigger => {
          if (otherTrigger !== trigger) {
            const otherIndex = otherTrigger.dataset.faqIndex;
            const otherAnswer = document.getElementById(`faq-answer-${otherIndex}`);
            otherTrigger.setAttribute('aria-expanded', 'false');
            otherAnswer.setAttribute('aria-hidden', 'true');
          }
        });
        
        // Toggle current FAQ
        trigger.setAttribute('aria-expanded', !isExpanded);
        answer.setAttribute('aria-hidden', isExpanded);
      });
    });
    
    // Keyboard navigation
    faqTriggers.forEach((trigger, index) => {
      trigger.addEventListener('keydown', (e) => {
        const isFirst = index === 0;
        const isLast = index === faqTriggers.length - 1;
        
        switch(e.key) {
          case 'ArrowUp':
            if (!isFirst) {
              e.preventDefault();
              faqTriggers[index - 1].focus();
            }
            break;
          case 'ArrowDown':
            if (!isLast) {
              e.preventDefault();
              faqTriggers[index + 1].focus();
            }
            break;
          case 'Home':
            e.preventDefault();
            faqTriggers[0].focus();
            break;
          case 'End':
            e.preventDefault();
            faqTriggers[faqTriggers.length - 1].focus();
            break;
        }
      });
    });
  });
</script>